<!doctype html>
<html lang="__MSG_@@ui_locale__">
<head>
  <meta charset="utf-8">
  <title>__MSG_appTitle__</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Primary stylesheet -->
  <link rel="stylesheet" href="css/sidepanel-layout.css">

  <!-- Fallback if sidepanel-layout.css fails to load -->
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #f5f6f8;
      font-family: "SÃ¶hne", "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: #222;
    }
    .frame-wrap {
      width: 100%;
      height: 100%;
      margin: 0 auto;
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
      display: flex;
      flex-direction: column;
    }
    .frame-header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.08);
      background: rgba(255, 255, 255, 0.92);
      color: #343541;
    }
    .frame-toolbar {
      display: grid;
      grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
      align-items: center;
      width: 100%;
      gap: 8px;
    }
    .frame-toolbar__zone {
      display: flex;
      align-items: center;
      min-width: 0;
    }
    .frame-toolbar__zone--left {
      justify-content: flex-start;
    }
    .frame-toolbar__zone--center {
      justify-content: center;
    }
    .frame-toolbar__zone--right {
      justify-content: flex-end;
    }
    .toolbar-tooltip {
      position: relative;
      display: inline-flex;
      align-items: center;
    }
    .toolbar-tooltip__bubble {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      transform: translate3d(0, 10px, 0);
      transform-origin: top right;
      background: rgba(15, 23, 42, 0.96);
      color: #f8fafc;
      padding: 10px 14px;
      border-radius: 12px;
      font: 400 13px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      white-space: normal;
      max-width: min(70vw, 320px);
      text-align: left;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.18), 0 4px 12px rgba(15, 23, 42, 0.14);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.16s ease, transform 0.18s ease;
      pointer-events: none;
      z-index: 2;
    }
    .toolbar-tooltip:hover .toolbar-tooltip__bubble,
    .toolbar-tooltip:focus-within .toolbar-tooltip__bubble {
      opacity: 1;
      visibility: visible;
      transform: translate3d(0, 0, 0);
    }
    .toolbar-btn {
      appearance: none;
      border: 0;
      margin: 0;
      padding: 0 12px;
      height: 32px;
      border-radius: 8px;
      background: transparent;
      color: inherit;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 14px;
      line-height: 1.2;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .toolbar-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }
    .toolbar-btn[aria-disabled="true"] {
      opacity: 0.55;
      cursor: default;
    }
    .toolbar-btn:hover,
    .toolbar-btn:focus-visible {
      background: rgba(15, 23, 42, 0.08);
    }
    .toolbar-btn[aria-pressed="true"],
    .toolbar-btn[aria-expanded="true"] {
      background: rgba(15, 23, 42, 0.08);
    }
    .toolbar-btn.is-loading svg {
      animation: toolbar-spin 1.2s linear infinite;
    }
    .toolbar-btn__label {
      display: inline-grid;
      grid-template-columns: 1fr;
      grid-template-rows: 1fr;
      align-items: center;
      justify-items: start;
      font-weight: 400;
      white-space: nowrap;
      text-align: left;
    }
    .toolbar-btn__label::before,
    .toolbar-btn__label::after {
      grid-area: 1 / 1 / 2 / 2;
      visibility: hidden;
      pointer-events: none;
    }
    .toolbar-btn__label::before {
      content: attr(data-label-default);
    }
    .toolbar-btn__label::after {
      content: attr(data-label-loading);
    }
    .toolbar-btn__label-content {
      grid-area: 1 / 1 / 2 / 2;
      justify-self: start;
    }
    .frame-body {
      flex: 1 1 auto;
      min-height: 0;
      position: relative;
      display: flex;
    }
    .portal-container,
    .settings-panel {
      flex: 1 1 100%;
      min-height: 0;
    }
    .portal-container {
      display: flex;
      flex-direction: column;
    }
    .portal-stage {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    #gpt-frame {
      display: block;
      width: 100%;
      height: 100%;
      border: 0;
    }
    .settings-panel {
      position: absolute;
      top: -1px;
      right: 0;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      padding: 16px;
      gap: 16px;
      background: #f8fafc;
      overflow-y: auto;
      z-index: 2;
    }
    .settings-panel[hidden] {
      display: none;
    }
    .settings-panel__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }
    .settings-panel__title {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }
    .settings-close-btn {
      appearance: none;
      border: 0;
      background: transparent;
      border-radius: 10px;
      width: 40px;
      height: 40px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: rgba(15, 23, 42, 0.65);
      cursor: pointer;
      box-shadow: none;
      transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
    }
    .settings-close-btn svg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }
    .settings-close-btn:hover,
    .settings-close-btn:focus-visible {
      background: #e9edf3;
      color: rgba(15, 23, 42, 0.9);
      box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.15), 0 1px 2px rgba(15, 23, 42, 0.08);
    }
    .settings-panel__body {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .settings-section {
      padding: 12px;
      border-radius: 10px;
      background: #fff;
    }
    .settings-section__title {
      margin: 0 0 6px;
      font-size: 14px;
      font-weight: 600;
    }
    .settings-section__hint {
      margin: 0 0 10px;
      font-size: 13px;
      color: rgba(15, 23, 42, 0.7);
    }
    .settings-select,
    .settings-option {
      font-size: 14px;
    }
    .settings-select {
      width: 100%;
      border-radius: 8px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 8px 12px;
      font-family: inherit;
    }
    .settings-fieldset {
      border: 0;
      margin: 0;
      padding: 0;
    }
    .settings-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .settings-option {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    @keyframes toolbar-spin {
      to { transform: rotate(1turn); }
    }
    body.theme-dark {
      background: #020617;
      color: #f1f5f9;
    }
    body.theme-dark .frame-wrap {
      background: #040c1a;
    }
    body.theme-dark .frame-header {
      color: #f8fafc;
      border-bottom-color: rgba(51, 65, 85, 0.6);
      background: rgba(2, 6, 23, 0.95);
    }
    body.theme-dark .toolbar-btn {
      color: #f8fafc;
    }
    body.theme-dark .toolbar-btn:hover,
    body.theme-dark .toolbar-btn:focus-visible {
      background: rgba(59, 130, 246, 0.2);
    }
    body.theme-dark .toolbar-tooltip__bubble {
      background: rgba(15, 23, 42, 0.95);
      color: #f1f5f9;
      border: 1px solid rgba(59, 130, 246, 0.35);
    }
    body.theme-dark .settings-panel {
      background: #050f1f;
      color: #f8fafc;
    }
    body.theme-dark .settings-panel__title {
      color: #f8fafc;
    }
    body.theme-dark .settings-section {
      background: #07162d;
      border: 1px solid rgba(59, 130, 246, 0.35);
    }
    body.theme-dark .settings-section__hint {
      color: rgba(226, 232, 240, 0.85);
    }
    body.theme-dark .settings-select {
      background: rgba(15, 23, 42, 0.85);
      border-color: rgba(59, 130, 246, 0.45);
      color: #f8fafc;
    }
    body.theme-dark .settings-option {
      border-color: rgba(59, 130, 246, 0.35);
      background: rgba(15, 23, 42, 0.65);
      color: #e2e8f0;
    }
    body.theme-dark .settings-option__label {
      color: #fff;
    }
    body.theme-dark .settings-option:has(input:checked) {
      border-color: rgba(16, 185, 129, 0.85);
      background: rgba(16, 185, 129, 0.2);
    }
    body.theme-dark .settings-close-btn {
      color: #f8fafc;
      background: transparent;
    }
    body.theme-dark .settings-close-btn:hover,
    body.theme-dark .settings-close-btn:focus-visible {
      background: rgba(148, 163, 184, 0.18);
      box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.55) inset;
      color: #fff;
    }

    @media (prefers-color-scheme: dark) {
      body.theme-auto {
        background: #020617;
        color: #f1f5f9;
      }
      body.theme-auto .frame-wrap {
        background: #040c1a;
      }
      body.theme-auto .frame-header {
        color: #f8fafc;
        border-bottom-color: rgba(51, 65, 85, 0.6);
        background: rgba(2, 6, 23, 0.95);
      }
      body.theme-auto .toolbar-btn {
        color: #f8fafc;
      }
      body.theme-auto .toolbar-btn:hover,
      body.theme-auto .toolbar-btn:focus-visible {
        background: rgba(59, 130, 246, 0.2);
      }
      body.theme-auto .toolbar-tooltip__bubble {
        background: rgba(15, 23, 42, 0.95);
        color: #f1f5f9;
        border: 1px solid rgba(59, 130, 246, 0.35);
      }
      body.theme-auto .settings-panel {
        background: #050f1f;
        color: #f8fafc;
      }
      body.theme-auto .settings-panel__title {
        color: #f8fafc;
      }
      body.theme-auto .settings-section {
        background: #07162d;
        border: 1px solid rgba(59, 130, 246, 0.35);
      }
      body.theme-auto .settings-section__hint {
        color: rgba(226, 232, 240, 0.85);
      }
      body.theme-auto .settings-select {
        background: rgba(15, 23, 42, 0.85);
        border-color: rgba(59, 130, 246, 0.45);
        color: #f8fafc;
      }
      body.theme-auto .settings-option {
        border-color: rgba(59, 130, 246, 0.35);
        background: rgba(15, 23, 42, 0.65);
        color: #e2e8f0;
      }
      body.theme-auto .settings-option__label {
        color: #fff;
      }
      body.theme-auto .settings-option:has(input:checked) {
        border-color: rgba(16, 185, 129, 0.85);
        background: rgba(16, 185, 129, 0.2);
      }
      body.theme-auto .settings-close-btn {
        color: #f8fafc;
        background: transparent;
      }
      body.theme-auto .settings-close-btn:hover,
      body.theme-auto .settings-close-btn:focus-visible {
        background: rgba(148, 163, 184, 0.18);
        box-shadow: 0 0 0 1px rgba(148, 163, 184, 0.55) inset;
        color: #fff;
      }
    }
  </style>
</head>
<body class="theme-auto">
  <div class="frame-wrap">
    <div class="frame-header">
      <div class="frame-toolbar" role="toolbar" aria-label="__MSG_appTitle__">
        <div class="frame-toolbar__zone frame-toolbar__zone--left">
          <button
            id="home-button"
            class="toolbar-btn"
            type="button"
            aria-pressed="true"
            aria-label="__MSG_homeButtonAriaLabel__"
          >
            <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
              <path d="M16 8.5l1.53 1.53-1.06 1.06L10 4.62l-6.47 6.47-1.06-1.06L10 2.5l4 4v-2h2v4zm-6-2.46l6 5.99V18H4v-5.97zM12 17v-5H8v5h4z"></path>
            </svg>
          </button>
        </div>
        <div class="frame-toolbar__zone frame-toolbar__zone--center">
          <div class="toolbar-tooltip">
            <button
              id="refresh-button"
              class="toolbar-btn"
              type="button"
              aria-describedby="refresh-chat-tooltip"
              aria-label="__MSG_refreshButtonAriaLabel__"
            >
              <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                <path d="M10.2 3.28c3.53 0 6.43 2.61 6.92 6h2.08l-3.5 4-3.5-4h2.32c-.45-1.97-2.21-3.45-4.32-3.45-1.45 0-2.73.71-3.54 1.78L4.95 5.66C6.23 4.2 8.11 3.28 10.2 3.28zm-.4 13.44c-3.52 0-6.43-2.61-6.92-6H.8l3.5-4c1.17 1.33 2.33 2.67 3.5 4H5.48c.45 1.97 2.21 3.45 4.32 3.45 1.45 0 2.73-.71 3.54-1.78l1.71 1.95c-1.28 1.46-3.15 2.38-5.25 2.38z"></path>
              </svg>
              <span
                class="toolbar-btn__label"
                aria-live="polite"
                data-label-default="__MSG_refreshButtonDefaultLabel__"
                data-label-loading="__MSG_refreshButtonLoadingLabel__"
              >
                <span class="toolbar-btn__label-content">__MSG_refreshButtonDefaultLabel__</span>
              </span>
            </button>
            <span id="refresh-chat-tooltip" role="tooltip" class="toolbar-tooltip__bubble">__MSG_refreshButtonTooltip__</span>
          </div>
        </div>
        <div class="frame-toolbar__zone frame-toolbar__zone--right">
          <button
            id="settings-button"
            class="toolbar-btn"
            type="button"
            aria-expanded="false"
            aria-pressed="false"
            aria-label="__MSG_settingsButtonAriaLabel__"
          >
            <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
              <path d="M18 12h-2.18c-.17.7-.44 1.35-.81 1.93l1.54 1.54-2.1 2.1-1.54-1.54c-.58.36-1.23.63-1.91.79V19H8v-2.18c-.68-.16-1.33-.43-1.91-.79l-1.54 1.54-2.12-2.12 1.54-1.54c-.36-.58-.63-1.23-.79-1.91H1V9.03h2.17c.16-.7.44-1.35.8-1.94L2.43 5.55l2.1-2.1 1.54 1.54c.58-.37 1.24-.64 1.93-.81V2h3v2.18c.68.16 1.33.43 1.91.79l1.54-1.54 2.12 2.12-1.54 1.54c.36.59.64 1.24.8 1.94H18V12zm-8.5 1.5c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <div class="frame-body">
      <div id="portal-container" class="portal-container">
        <div class="portal-stage">
          <iframe
            id="gpt-frame"
            allow="clipboard-read *; clipboard-write *; autoplay; microphone; camera"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>
      </div>
      <div id="settings-panel" class="settings-panel" hidden>
        <div class="settings-panel__header">
          <h2 class="settings-panel__title">__MSG_settingsTitle__</h2>
          <button
            id="settings-close-button"
            type="button"
            class="settings-close-btn"
            aria-label="__MSG_settingsCloseLabel__"
          >
            <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
              <path d="M6.28 4.22L10.06 8l3.78-3.78 1.06 1.06L11.12 9.06l3.78 3.78-1.06 1.06-3.78-3.78-3.78 3.78-1.06-1.06 3.78-3.78-3.78-3.78z"></path>
            </svg>
          </button>
        </div>
        <div class="settings-panel__body">
          <section class="settings-section" aria-labelledby="settings-language-title">
            <h3
              id="settings-language-title"
              class="settings-section__title"
              data-i18n-key="settingsExtensionLanguageTitle"
            >__MSG_settingsExtensionLanguageTitle__</h3>
            <p
              id="settings-language-hint"
              class="settings-section__hint"
              data-i18n-key="settingsExtensionLanguageHint"
            >__MSG_settingsExtensionLanguageHint__</p>
            <select
              id="extension-language-select"
              class="settings-select"
              aria-describedby="settings-language-hint"
            >
              <option value="en" data-i18n-key="settingsLanguageEnglish">__MSG_settingsLanguageEnglish__</option>
              <option value="zh-CN" data-i18n-key="settingsLanguageChineseChina">__MSG_settingsLanguageChineseChina__</option>
              <option value="fr" data-i18n-key="settingsLanguageFrench">__MSG_settingsLanguageFrench__</option>
              <option value="hi" data-i18n-key="settingsLanguageHindi">__MSG_settingsLanguageHindi__</option>
              <option value="pt-BR" data-i18n-key="settingsLanguagePortugueseBrazil">__MSG_settingsLanguagePortugueseBrazil__</option>
              <option value="ru" data-i18n-key="settingsLanguageRussian">__MSG_settingsLanguageRussian__</option>
              <option value="es" data-i18n-key="settingsLanguageSpanish">__MSG_settingsLanguageSpanish__</option>
              <option value="de" data-i18n-key="settingsLanguageGerman">__MSG_settingsLanguageGerman__</option>
              <option value="it" data-i18n-key="settingsLanguageItalian">__MSG_settingsLanguageItalian__</option>
              <option value="ja" data-i18n-key="settingsLanguageJapanese">__MSG_settingsLanguageJapanese__</option>
            </select>
          </section>
          <section class="settings-section" aria-labelledby="settings-theme-title">
            <h3
              id="settings-theme-title"
              class="settings-section__title"
              data-i18n-key="settingsThemeTitle"
            >__MSG_settingsThemeTitle__</h3>
            <p
              id="settings-theme-hint"
              class="settings-section__hint"
              data-i18n-key="settingsThemeHint"
            >__MSG_settingsThemeHint__</p>
            <fieldset class="settings-fieldset" aria-describedby="settings-theme-hint">
              <div class="settings-options">
                <label class="settings-option">
                  <input type="radio" name="theme-mode" value="auto" checked>
                  <span class="settings-option__label" data-i18n-key="settingsThemeAuto">__MSG_settingsThemeAuto__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="theme-mode" value="light">
                  <span class="settings-option__label" data-i18n-key="settingsThemeLight">__MSG_settingsThemeLight__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="theme-mode" value="dark">
                  <span class="settings-option__label" data-i18n-key="settingsThemeDark">__MSG_settingsThemeDark__</span>
                </label>
              </div>
            </fieldset>
          </section>
          <section class="settings-section" aria-labelledby="settings-sidebar-defaults-title">
            <h3
              id="settings-sidebar-defaults-title"
              class="settings-section__title"
              data-i18n-key="settingsSidebarDefaultsTitle"
            >__MSG_settingsSidebarDefaultsTitle__</h3>
            <p
              id="settings-sidebar-defaults-hint"
              class="settings-section__hint"
              data-i18n-key="settingsSidebarDefaultsHint"
            >__MSG_settingsSidebarDefaultsHint__</p>
            <fieldset class="settings-fieldset" aria-describedby="settings-sidebar-defaults-hint">
              <div class="settings-options">
                <label class="settings-option">
                  <input
                    type="checkbox"
                    id="toggle-expand-projects"
                    data-i18n-aria="settingsExpandProjectsLabel"
                  >
                  <span class="settings-option__label" data-i18n-key="settingsExpandProjectsLabel">__MSG_settingsExpandProjectsLabel__</span>
                </label>
                <label class="settings-option">
                  <input
                    type="checkbox"
                    id="toggle-expand-charts"
                    data-i18n-aria="settingsExpandChartsLabel"
                  >
                  <span class="settings-option__label" data-i18n-key="settingsExpandChartsLabel">__MSG_settingsExpandChartsLabel__</span>
                </label>
                <label class="settings-option">
                  <input
                    type="checkbox"
                    id="toggle-expand-chats"
                    data-i18n-aria="settingsExpandChatsLabel"
                  >
                  <span class="settings-option__label" data-i18n-key="settingsExpandChatsLabel">__MSG_settingsExpandChatsLabel__</span>
                </label>
              </div>
            </fieldset>
          </section>
        </div>
      </div>
    </div>
  </div>

  <!-- Sidepanel bootstrap logic -->
  <script src="js/sidepanel-bootstrap.js"></script>
</body>
</html>

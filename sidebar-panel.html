<!doctype html>
<html lang="__MSG_@@ui_locale__">
<head>
  <meta charset="utf-8">
  <title>__MSG_appTitle__</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Primary stylesheet -->
  <link rel="stylesheet" href="css/sidepanel-layout.css">

  <!-- Fallback if sidepanel-layout.css fails to load -->
  <style>
    html,
    body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #f5f6f8;
      font-family: "SÃ¶hne", "Helvetica Neue", Helvetica, Arial, sans-serif;
      color: #222;
    }
    .frame-wrap {
      width: 100%;
      height: 100%;
      border-radius: 12px;
      overflow: hidden;
      background: #fff;
      display: flex;
      flex-direction: column;
    }
    .frame-header {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
      border-bottom: 1px solid rgba(15, 23, 42, 0.08);
      background: rgba(255, 255, 255, 0.92);
      color: #343541;
    }
    .frame-toolbar {
      display: grid;
      grid-template-columns: minmax(0, 1fr) auto minmax(0, 1fr);
      align-items: center;
      width: 100%;
      gap: 8px;
    }
    .frame-toolbar__zone {
      display: flex;
      align-items: center;
      min-width: 0;
    }
    .frame-toolbar__zone--left {
      justify-content: flex-start;
    }
    .frame-toolbar__zone--center {
      justify-content: center;
    }
    .frame-toolbar__zone--right {
      justify-content: flex-end;
    }
    .toolbar-tooltip {
      position: relative;
      display: inline-flex;
      align-items: center;
    }
    .toolbar-tooltip__bubble {
      position: absolute;
      top: calc(100% + 8px);
      right: 0;
      transform: translate3d(0, 10px, 0);
      transform-origin: top right;
      background: rgba(15, 23, 42, 0.96);
      color: #f8fafc;
      padding: 10px 14px;
      border-radius: 12px;
      font: 400 13px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      white-space: normal;
      max-width: min(70vw, 320px);
      text-align: left;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.18), 0 4px 12px rgba(15, 23, 42, 0.14);
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.16s ease, transform 0.18s ease;
      pointer-events: none;
      z-index: 2;
    }
    .toolbar-tooltip:hover .toolbar-tooltip__bubble,
    .toolbar-tooltip:focus-within .toolbar-tooltip__bubble {
      opacity: 1;
      visibility: visible;
      transform: translate3d(0, 0, 0);
    }
    .toolbar-btn {
      appearance: none;
      border: 0;
      margin: 0;
      padding: 0 12px;
      height: 32px;
      border-radius: 8px;
      background: transparent;
      color: inherit;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 14px;
      line-height: 1.2;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s ease, color 0.2s ease;
    }
    .toolbar-btn svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }
    .toolbar-btn[aria-disabled="true"] {
      opacity: 0.55;
      cursor: default;
    }
    .toolbar-btn:hover,
    .toolbar-btn:focus-visible {
      background: rgba(15, 23, 42, 0.08);
    }
    .toolbar-btn.is-loading svg {
      animation: toolbar-spin 1.2s linear infinite;
    }
    .toolbar-btn__label {
      display: inline-grid;
      grid-template-columns: 1fr;
      grid-template-rows: 1fr;
      align-items: center;
      justify-items: center;
      font-weight: 400;
      white-space: nowrap;
    }
    .toolbar-btn__label::before,
    .toolbar-btn__label::after {
      grid-area: 1 / 1 / 2 / 2;
      visibility: hidden;
      pointer-events: none;
    }
    .toolbar-btn__label::before {
      content: attr(data-label-default);
    }
    .toolbar-btn__label::after {
      content: attr(data-label-loading);
    }
    .toolbar-btn__label-content {
      grid-area: 1 / 1 / 2 / 2;
    }
    .frame-body {
      flex: 1 1 auto;
      min-height: 0;
      position: relative;
      display: flex;
    }
    .portal-container,
    .settings-panel {
      flex: 1 1 100%;
      min-height: 0;
    }
    .portal-container {
      display: flex;
      flex-direction: column;
    }
    .portal-stage {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    #gpt-frame {
      display: block;
      width: 100%;
      height: 100%;
      border: 0;
    }
    .settings-panel {
      display: flex;
      flex-direction: column;
      padding: 16px;
      gap: 16px;
      background: #f8fafc;
    }
    .settings-panel[hidden] {
      display: none;
    }
    .settings-panel__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }
    .settings-panel__title {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }
    .settings-close-btn {
      appearance: none;
      border: 0;
      background: transparent;
      border-radius: 999px;
      width: 32px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      line-height: 1;
      color: inherit;
      cursor: pointer;
    }
    .settings-panel__body {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .settings-section {
      padding: 12px;
      border-radius: 10px;
      background: #fff;
    }
    .settings-section__title {
      margin: 0 0 6px;
      font-size: 14px;
      font-weight: 600;
    }
    .settings-section__hint {
      margin: 0 0 10px;
      font-size: 13px;
      color: rgba(15, 23, 42, 0.7);
    }
    .settings-select,
    .settings-option {
      font-size: 14px;
    }
    .settings-select {
      width: 100%;
      border-radius: 8px;
      border: 1px solid rgba(15, 23, 42, 0.2);
      padding: 8px 12px;
      font-family: inherit;
    }
    .settings-fieldset {
      border: 0;
      margin: 0;
      padding: 0;
    }
    .settings-options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .settings-option {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    @keyframes toolbar-spin {
      to { transform: rotate(1turn); }
    }
    @media (prefers-color-scheme: dark) {
      html, body {
        background: #0d0f12;
        color: #e2e8f0;
      }
      .frame-wrap {
        background: #111418;
      }
      .frame-header {
        color: #ececf1;
        border-bottom-color: rgba(100, 116, 139, 0.32);
        background: rgba(13, 16, 20, 0.9);
      }
      .toolbar-btn {
        color: inherit;
      }
      .toolbar-btn:hover,
      .toolbar-btn:focus-visible {
        background: rgba(148, 163, 184, 0.16);
      }
      .toolbar-tooltip__bubble {
        background: rgba(15, 23, 42, 0.94);
        color: #e2e8f0;
        border: 1px solid rgba(148, 163, 184, 0.28);
      }
      .settings-panel {
        background: #0f172a;
      }
      .settings-section {
        background: #111827;
      }
    }
  </style>
</head>
<body>
  <div class="frame-wrap">
    <div class="frame-header">
      <div class="frame-toolbar" role="toolbar" aria-label="__MSG_appTitle__">
        <div class="frame-toolbar__zone frame-toolbar__zone--left">
          <div class="toolbar-tooltip">
            <button
              id="home-button"
              class="toolbar-btn"
              type="button"
              aria-describedby="home-button-tooltip"
              aria-label="__MSG_headerHomeLabel__"
            >
              <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                <path d="M16 8.5l1.53 1.53-1.06 1.06L10 4.62l-6.47 6.47-1.06-1.06L10 2.5l4 4v-2h2v4zm-6-2.46l6 5.99V18H4v-5.97zM12 17v-5H8v5h4z"></path>
              </svg>
              <span class="toolbar-btn__label">
                <span class="toolbar-btn__label-content">__MSG_headerHomeLabel__</span>
              </span>
            </button>
            <span id="home-button-tooltip" role="tooltip" class="toolbar-tooltip__bubble">__MSG_headerHomeTooltip__</span>
          </div>
        </div>
        <div class="frame-toolbar__zone frame-toolbar__zone--center">
          <div class="toolbar-tooltip">
            <button
              id="refresh-button"
              class="toolbar-btn"
              type="button"
              aria-describedby="refresh-chat-tooltip"
              aria-label="__MSG_headerRefreshLabel__"
            >
              <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                <path d="M10.2 3.28c3.53 0 6.43 2.61 6.92 6h2.08l-3.5 4-3.5-4h2.32c-.45-1.97-2.21-3.45-4.32-3.45-1.45 0-2.73.71-3.54 1.78L4.95 5.66C6.23 4.2 8.11 3.28 10.2 3.28zm-.4 13.44c-3.52 0-6.43-2.61-6.92-6H.8l3.5-4c1.17 1.33 2.33 2.67 3.5 4H5.48c.45 1.97 2.21 3.45 4.32 3.45 1.45 0 2.73-.71 3.54-1.78l1.71 1.95c-1.28 1.46-3.15 2.38-5.25 2.38z"></path>
              </svg>
              <span
                class="toolbar-btn__label"
                aria-live="polite"
                data-label-default="__MSG_headerRefreshLabel__"
                data-label-loading="__MSG_headerRefreshLoadingLabel__"
              >
                <span class="toolbar-btn__label-content">__MSG_headerRefreshLabel__</span>
              </span>
            </button>
            <span id="refresh-chat-tooltip" role="tooltip" class="toolbar-tooltip__bubble">__MSG_headerRefreshTooltip__</span>
          </div>
        </div>
        <div class="frame-toolbar__zone frame-toolbar__zone--right">
          <div class="toolbar-tooltip">
            <button
              id="settings-button"
              class="toolbar-btn"
              type="button"
              aria-describedby="settings-button-tooltip"
              aria-expanded="false"
              aria-label="__MSG_headerSettingsLabel__"
            >
              <svg viewBox="0 0 20 20" aria-hidden="true" focusable="false">
                <path d="M18 12h-2.18c-.17.7-.44 1.35-.81 1.93l1.54 1.54-2.1 2.1-1.54-1.54c-.58.36-1.23.63-1.91.79V19H8v-2.18c-.68-.16-1.33-.43-1.91-.79l-1.54 1.54-2.12-2.12 1.54-1.54c-.36-.58-.63-1.23-.79-1.91H1V9.03h2.17c.16-.7.44-1.35.8-1.94L2.43 5.55l2.1-2.1 1.54 1.54c.58-.37 1.24-.64 1.93-.81V2h3v2.18c.68.16 1.33.43 1.91.79l1.54-1.54 2.12 2.12-1.54 1.54c.36.59.64 1.24.8 1.94H18V12zm-8.5 1.5c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"></path>
              </svg>
              <span class="toolbar-btn__label">
                <span class="toolbar-btn__label-content">__MSG_headerSettingsLabel__</span>
              </span>
            </button>
            <span id="settings-button-tooltip" role="tooltip" class="toolbar-tooltip__bubble">__MSG_headerSettingsTooltip__</span>
          </div>
        </div>
      </div>
    </div>
    <div class="frame-body">
      <div id="portal-container" class="portal-container">
        <div class="portal-stage">
          <iframe
            id="gpt-frame"
            allow="clipboard-read *; clipboard-write *; autoplay; microphone; camera"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>
      </div>
      <div id="settings-panel" class="settings-panel" hidden>
        <div class="settings-panel__header">
          <h2 class="settings-panel__title">__MSG_settingsTitle__</h2>
          <button
            id="settings-close-button"
            type="button"
            class="settings-close-btn"
            aria-label="__MSG_settingsCloseLabel__"
          >
            &times;
          </button>
        </div>
        <div class="settings-panel__body">
          <section class="settings-section" aria-labelledby="settings-language-title">
            <h3 id="settings-language-title" class="settings-section__title">__MSG_settingsExtensionLanguageTitle__</h3>
            <p id="settings-language-hint" class="settings-section__hint">__MSG_settingsExtensionLanguageHint__</p>
            <select
              id="extension-language-select"
              class="settings-select"
              aria-describedby="settings-language-hint"
            >
              <option value="en">__MSG_settingsLanguageEnglish__</option>
              <option value="zh-CN">__MSG_settingsLanguageChineseChina__</option>
              <option value="fr">__MSG_settingsLanguageFrench__</option>
              <option value="hi">__MSG_settingsLanguageHindi__</option>
              <option value="pt-BR">__MSG_settingsLanguagePortugueseBrazil__</option>
              <option value="ru">__MSG_settingsLanguageRussian__</option>
              <option value="es">__MSG_settingsLanguageSpanish__</option>
            </select>
          </section>
          <section class="settings-section" aria-labelledby="settings-domain-title">
            <h3 id="settings-domain-title" class="settings-section__title">__MSG_settingsDomainTitle__</h3>
            <p id="settings-domain-hint" class="settings-section__hint">__MSG_settingsDomainHint__</p>
            <fieldset class="settings-fieldset" aria-describedby="settings-domain-hint">
              <div class="settings-options">
                <label class="settings-option">
                  <input type="radio" name="domain-mode" value="auto" checked>
                  <span>__MSG_settingsDomainAuto__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="domain-mode" value="chatgpt.com">
                  <span>__MSG_settingsDomainChatgptCom__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="domain-mode" value="chat.openai.com">
                  <span>__MSG_settingsDomainChatOpenaiCom__</span>
                </label>
              </div>
            </fieldset>
          </section>
          <section class="settings-section" aria-labelledby="settings-size-title">
            <h3 id="settings-size-title" class="settings-section__title">__MSG_settingsSizeTitle__</h3>
            <p id="settings-size-hint" class="settings-section__hint">__MSG_settingsSizeHint__</p>
            <fieldset class="settings-fieldset" aria-describedby="settings-size-hint">
              <div class="settings-options">
                <label class="settings-option">
                  <input type="radio" name="panel-size" value="S">
                  <span>__MSG_settingsSizeSLabel__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="panel-size" value="M" checked>
                  <span>__MSG_settingsSizeMLabel__</span>
                </label>
                <label class="settings-option">
                  <input type="radio" name="panel-size" value="L">
                  <span>__MSG_settingsSizeLLabel__</span>
                </label>
              </div>
            </fieldset>
          </section>
        </div>
      </div>
    </div>
  </div>

  <!-- Domain selection and iframe src logic lives here -->
  <script src="js/sidepanel-bootstrap.js"></script>
</body>
</html>
